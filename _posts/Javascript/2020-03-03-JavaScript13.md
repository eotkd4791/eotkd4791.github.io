---
title: "JavaScript 정규표현식"
categories:
  - JavaScript
tags:
  - JavaScript
read_time: false
toc: true
toc_sticky: true
---


## 정규표현식

정규표현식(정규식)은 특정한 규칙을 가진 문자열의 집합을 표현하는 데 사용하는 형식 언어이다. 정규표현식을 이용하면 문자열 검색, 교체가 가능하기 때문에 웹사이트의 사용자 입력을 검사하거나, 이메일 주소, URL, 전화번호 등의 문자열 찾는 것에 매우 유용하다. 

정규표현식은 범위가 상당히 넓으므로 learning javascript(Ethan Brown 저, 한선용 역)을 읽으며 알게된 내용을 위주로 정리해보겠다.


## 정규식 만들기

정규식을 만드는 방법은 리터럴 문법을 이용하는 방법과 RegExp 생성자로 만드는 방법이 있다. 리터럴 문법을 이용하여 정규식을 만드는 것이 더 간편하며, 동적 정규표현식을 만들 때에는 RegExp 생성자를 이용한다.

```js
const regByLiteral = /string/;                 //리터럴 방식
const regByConstructor = new RegExp("string"); //생성자 방식
```


## 정규식 검색/교체

정규식을 검색하는 방법은 String.prototype.match 메소드와 RegExp.prototype.test 메소드를 이용하는 방법이 있고, 교체하는 방법으로는 String.prototype.replace가 있다. 

주어진 문자열 str에서 대소문자 상관없이 다섯 글자 이상의 문자열을 찾는 예제를 통해서 살펴보겠다. 아래 예제에서 등장하는 메타 언어는 다음 다음 챕터에서 알아보겠다. 메소드의 사용법에 대해서만 이해하고 넘어가자.

```js
const str = "Hello, my name is Stephen";
```

```js
//match 메소드를 이용한 방법
str.match(/\w{5,}/ig);

//["Hello", "Stephen"] 배열 형식으로 출력된다.

str.match(/\w{10,}/ig);
//정규식이 찾는 문자열에 해당하지 않는다면, null이 반환된다.
```

```js
//test 메소드를 이용한 방법
/\w{5,}/ig.test(str);

//true

/\w{11,}/ig.test(str);

//false (11글자 이상의 문자가 없다. 따라서 false 반환)
```

```js
//replace 메소드를 이용하여 교체하기
str.replace(/\w{5,}/ig, '****');

// "**** my name is ****" 문자열 형식으로 해당 문자열을 반환한다.

str.replace(/\w{10,}/ig, '****');

//정규식에 해당하는 문자열이 없다면, 기존의 문자열을 그대로 반환한다.
//"Hello, my name is Stephen"
```


## 정규식의 입력 소비

정규식은 무조건 문자열의 왼쪽에서 오른쪽으로 검색하면서 찾는 값이 존재할 가능성을 판단한다. 가능성이 없는 경우에는 바로 해당 문자를 소비하고, 가능성이 있으면 소비하지 않고, 계속 진행한다. 그러다 일치하는 문자열을 찾으면 찾은 것을 모두 소비한다. 예제를 통해서 확인해보자.

```js
const target = ["KOR", "KOREA", "KOREAN", "KETCHUP", "CHIPS"];

const str = "KOREANKETCHUPPCHIPS";
```

문자열 str에서 target에 담겨있는 값을 찾는 예제이다. 정규식은 무조건 문자열의 왼쪽에서 오른쪽으로 본다고 앞서 언급했다. 


K O R E A N K E T C H U P P C H I P S<br>
👆K로 시작하는 문자열이 target에 존재하므로 소비하지 않는다.

K O R E A N K E T C H U P P C H I P S<br>
\t👆 "KO" 가능한 문자열이 있다. -> 소비하지 않는다.

K O R E A N K E T C H U P P C H I P S<br>
    👆 "KOR" 문자열을 찾았다. "KOR"을 한번에 소비한다.

K O R E A N K E T C H U P P C H I P S<br>
      👆 E로 시작하는 문자열이 없다. 소비한다.

K O R E A N K E T C H U P P C H I P S<br>
        👆 A로 시작하는 문자열이 없다. 소비한다.

K O R E A N K E T C H U P P C H I P S<br>
          👆 N로 시작하는 문자열이 없다. 소비한다.


이러한 방식으로 문자열을 검색한다. 따라서 "KOR", "KETCHUP", "CHIPS"를 찾을 수 있다. "KOREA", "KOREAN"은 "KOR"을 찾자마자 모두 소비하기 때문에 "EA", "EAN"으로만 인식한다. 따라서 찾지 못한다.

![](/asserts/img/js/입력소비.png)


## 메타 문자 및 정규식 작성 방법

정규식은 /로 시작해서 /로 끝난다. 정규식 뒤에 오는 문자를 플래그(flag)라고 하는데, 자주 쓰이는 플래그에는 i와 g, m이 있다. i는 대소문자를 가리지 않는다는 의미이고, g는 전체 범위를 검색하라는 의미이다. g플래그가 없으면 일치하는 것중 첫 번째만 반환된다. m은 줄바꿈이 있어도 계속해서 찾는다는 것을 의미한다.

정규식에서 |는 OR을 뜻하는 메타 문자이며, [ ] 범위 설정할 때 사용한다.

ex) 숫자를 찾는 정규식

```js
const str = "Hello79 ";

const findNum = str.match(/0|1|2|3|4|5|6|7|8|9|/g);
// 비효율적.

const findNUm = str.match(/[0123456789]/g);
//또는
const findNum = str.match(/[0-9]/g);
//위와 같이 쓸 수 있다.

const findAll = str.match(/[\-0-9a-z.]/ig);
//문자와 숫자를 모두 찾는 정규식
const findAll = str.match(/[.a-z0-9\-]/ig);
//와 같이 쓸 수 있다. 하이픈(-)은 esc해야한다. esc안하는 경우에는 범위를 표시하는 메타문자로 간주하기 때문.

//특정 문자 또는 범위를 제외하고 찾을때 ^를 이용한다.
const findExc = str.match(/[^\-0-9a-z.]/);
//문자와 숫자를 제외하고 마지막 인덱스에 위치한 공백을 찾는다.
```


[0-9] => \d
[^0-9] => \D
[\t\v\n\r] => \s 탭, 공백, 세로탭, 줄바꿈 찾기
[^\t\v\n\r] => \S
[a-zA-Z_] => \w
[^a-zA-Z_] => \W

*는 숫자는 상관없으며 없어도 된다는 의미


## 반복(수량자)

얼마나 많이 일치해야 하는지 지정할 때 쓴다.

```js
const findMany = str.match(/[0-9][0-9][0-9]|[0-9][0-9]|[0-9]/);
```

한 자리, 두 자리, 세 자리 숫자가 연속되는 것을 찾는다. 정규식의 특성상 조건에 해당하는 문자열을 찾았을 때, 바로 소비하기 때문에 세 자리, 두 자리, 한 자리를 찾는 정규식 순서대로 썼다.

```js
const findMany = str.match(/[0-9]+/);
```

위의 정규식은 네 자리가 연속되는 숫자는 찾지 못하기 때문에 '+'를 써서 숫자가 연속하는 경우를 찾아낸다.

이 밖의 경우에도 반복되는 내용을 찾을 때 중괄호{}를 활용한다. {n}은 정확히 n개의 문자가 연속하는 경우를 찾아낸다. 위에서 언급한 \d를 활용하여 \d{5}와 같이 쓰면 다섯 자리의 숫자를 찾아낼 수 있다. 대표적인 예로 우편번호가 있다. 우편번호는 항상 다섯 자리로 이루어져 있기 때문에 정규식 /\d{5}/로 쉽게 찾아낼 수 있다.

n개 이상의 문자를 찾아내는 정규식은 {n,}이다. n뒤에 ,를 붙이면 n개 이상의 문자를 찾아낼 수 있다. 세 자리 이상 연속하는 문자 찾기를 아래의 예제와 살펴보자.

```js
const findChar = str.match(/\w{3,}/ig);
```

대소문자 구분없이 전체 범위에서 세 자리 이상 연속하는 문자를 찾는다. 

위에서는 정확히 n개로 이루어진 문자와 n개 이상으로 이루어진 문자를 찾는 방법을 살펴보았다. 찾는 글자 수의 범위를 지정하여 찾을 수도 있다. n개 이상, m개 이하의 문자 또는 숫자를 찾을 때에는 {n, m}와 같이 표기한다. 아래에는 3자리 이상, 5자리 이하의 갯수로 연속하는 숫자를 찾는 정규식을 표현해보았다.

```js
const findNum = str.match(/\d{3,5}/);
```

이 밖에

## 마침표와 이스케이프


## 그룹

```js
const text = "Visit eotkd4791.github.io today!";

const findMatch = text.match(/[a-z]+(?:\.com|\.io|\.org|\.net)/i);
```

```js
const html = 
  '<link rel="stylesheet" href="http://gmail.com/stuff.css">\n' + 
  '<link rel= stylesheet" href="https://www.vuejs.org">\n' +
  '<link rel= stylesheet" href="https://eotkd4791.github.io/grid.css">'

const matched = html.match(/(?:https?)?\/\/[a-z][a-z0-9-]+[a-z0-9]+/ig);
```


## 적극적 일치(greedy matching)와 소극적 일치(lazy matching)


## 역참조(backreference)

```js
const note = "We are looking for an album made by ABBA! Text me if you are interested! -ANNA-"

const findSub = note.matc(/([A-Z])([A-Z])\2\1/g);
```

```js
const html = `<img alt='A "simple" example.'>` + `<img alt="Don't abuse it!">`;

const find = html.match(/<img alt=(['"]).*?\1/g);
```


## 그룹 교체

```js
let html = '<a class="nope" href="/yep">Yep</a>';

html = html.replace(/<a.*?(href=".*?").*?>/, '<a $1>');
```

<br><br>
>참고 자료<br>
>Learning JavaScript Ethan Brown 저, 한선용 역